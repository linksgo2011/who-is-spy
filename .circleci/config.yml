version: 2
jobs:
  build:
    machine:
      java:
        version: oraclejdk8

    working_directory: ~/whoisspy

    steps:

      - checkout

      - run: ./gradlew clean build

      - store_artifacts:
          path: build/libs/whoisspy-0.0.1-SNAPSHOT.jar

  deploy:
    machine: true
    working_directory: ./build
    steps:
      - run:
          name: Display whole list
          command: ls -al

      - run:
          name: Display current position
          command: pwd

workflows:
  version: 2
  build-deploy:
    jobs:
      - build
      - deploy:
          requires:
            - build
          filters:
            branches:
              only: set-ci
